-----------------------------------
-----------------------------------
Number of npz files to read: 102
-----------------------------------
Read file: S1000e-12_H230_T-17_data_train.npy.npz
Read file: S1000e-12_H230_T-18_data_train.npy.npz
Read file: S1000e-12_H230_T-19_data_train.npy.npz
Read file: S1000e-12_H230_T-20_data_train.npy.npz
Read file: S1000e-12_H240_T-17_data_train.npy.npz
Read file: S1000e-12_H240_T-18_data_train.npy.npz
Read file: S1000e-12_H240_T-19_data_train.npy.npz
Read file: S1000e-12_H240_T-20_data_train.npy.npz
Read file: S1000e-12_H250_T-17_data_train.npy.npz
Read file: S1000e-12_H250_T-18_data_train.npy.npz
Read file: S1000e-12_H250_T-19_data_train.npy.npz
Read file: S1000e-12_H250_T-20_data_train.npy.npz
Read file: S1000e-12_H260_T-17_data_train.npy.npz
Read file: S1000e-12_H260_T-18_data_train.npy.npz
Read file: S1000e-12_H260_T-19_data_train.npy.npz
Read file: S1000e-12_H260_T-20_data_train.npy.npz
Read file: S1000e-12_H270_T-17_data_train.npy.npz
Read file: S1000e-12_H270_T-18_data_train.npy.npz
Read file: S1000e-12_H270_T-19_data_train.npy.npz
Read file: S1000e-12_H270_T-20_data_train.npy.npz
Read file: S100e-12_H70_T-23_data_train.npy.npz
Read file: S100e-12_H70_T-24_data_train.npy.npz
Read file: S100e-12_H70_T-25_data_train.npy.npz
Read file: S100e-12_H80_T-23_data_train.npy.npz
Read file: S100e-12_H80_T-24_data_train.npy.npz
Read file: S100e-12_H80_T-25_data_train.npy.npz
Read file: S100e-12_H90_T-23_data_train.npy.npz
Read file: S100e-12_H90_T-24_data_train.npy.npz
Read file: S100e-12_H90_T-25_data_train.npy.npz
Read file: S1500e-12_H280_T-15_data_train.npy.npz
Read file: S1500e-12_H280_T-16_data_train.npy.npz
Read file: S1500e-12_H280_T-17_data_train.npy.npz
Read file: S1500e-12_H280_T-18_data_train.npy.npz
Read file: S1500e-12_H290_T-15_data_train.npy.npz
Read file: S1500e-12_H290_T-16_data_train.npy.npz
Read file: S1500e-12_H290_T-17_data_train.npy.npz
Read file: S1500e-12_H290_T-18_data_train.npy.npz
Read file: S1500e-12_H300_T-15_data_train.npy.npz
Read file: S1500e-12_H300_T-16_data_train.npy.npz
Read file: S1500e-12_H300_T-17_data_train.npy.npz
Read file: S1500e-12_H300_T-18_data_train.npy.npz
Read file: S1500e-12_H310_T-15_data_train.npy.npz
Read file: S1500e-12_H310_T-16_data_train.npy.npz
Read file: S1500e-12_H310_T-17_data_train.npy.npz
Read file: S1500e-12_H310_T-18_data_train.npy.npz
Read file: S1500e-12_H320_T-15_data_train.npy.npz
Read file: S1500e-12_H320_T-16_data_train.npy.npz
Read file: S1500e-12_H320_T-17_data_train.npy.npz
Read file: S1500e-12_H320_T-18_data_train.npy.npz
Read file: S1500e-12_H330_T-15_data_train.npy.npz
Read file: S1500e-12_H330_T-16_data_train.npy.npz
Read file: S1500e-12_H330_T-17_data_train.npy.npz
Read file: S1500e-12_H330_T-18_data_train.npy.npz
Read file: S1e-12_H1_T-25_data_train.npy.npz
Read file: S1e-12_H1_T-26_data_train.npy.npz
Read file: S200e-12_H100_T-22_data_train.npy.npz
Read file: S200e-12_H100_T-23_data_train.npy.npz
Read file: S200e-12_H100_T-24_data_train.npy.npz
Read file: S200e-12_H100_T-25_data_train.npy.npz
Read file: S200e-12_H110_T-22_data_train.npy.npz
Read file: S200e-12_H110_T-23_data_train.npy.npz
Read file: S200e-12_H110_T-24_data_train.npy.npz
Read file: S200e-12_H110_T-25_data_train.npy.npz
Read file: S200e-12_H120_T-22_data_train.npy.npz
Read file: S200e-12_H120_T-23_data_train.npy.npz
Read file: S200e-12_H120_T-24_data_train.npy.npz
Read file: S200e-12_H120_T-25_data_train.npy.npz
Read file: S200e-12_H130_T-22_data_train.npy.npz
Read file: S200e-12_H130_T-23_data_train.npy.npz
Read file: S200e-12_H130_T-24_data_train.npy.npz
Read file: S200e-12_H130_T-25_data_train.npy.npz
Read file: S200e-12_H80_T-22_data_train.npy.npz
Read file: S200e-12_H80_T-23_data_train.npy.npz
Read file: S200e-12_H80_T-24_data_train.npy.npz
Read file: S200e-12_H80_T-25_data_train.npy.npz
Read file: S200e-12_H90_T-22_data_train.npy.npz
Read file: S200e-12_H90_T-23_data_train.npy.npz
Read file: S200e-12_H90_T-24_data_train.npy.npz
Read file: S200e-12_H90_T-25_data_train.npy.npz
Read file: S20e-12_H20_T-25_data_train.npy.npz
Read file: S20e-12_H20_T-26_data_train.npy.npz
Read file: S500e-12_H160_T-20_data_train.npy.npz
Read file: S500e-12_H160_T-21_data_train.npy.npz
Read file: S500e-12_H160_T-22_data_train.npy.npz
Read file: S500e-12_H170_T-20_data_train.npy.npz
Read file: S500e-12_H170_T-21_data_train.npy.npz
Read file: S500e-12_H170_T-22_data_train.npy.npz
Read file: S500e-12_H180_T-20_data_train.npy.npz
Read file: S500e-12_H180_T-21_data_train.npy.npz
Read file: S500e-12_H180_T-22_data_train.npy.npz
Read file: S500e-12_H190_T-20_data_train.npy.npz
Read file: S500e-12_H190_T-21_data_train.npy.npz
Read file: S500e-12_H190_T-22_data_train.npy.npz
Read file: S70e-12_H50_T-24_data_train.npy.npz
Read file: S70e-12_H50_T-25_data_train.npy.npz
Read file: S70e-12_H50_T-26_data_train.npy.npz
Read file: S70e-12_H60_T-24_data_train.npy.npz
Read file: S70e-12_H60_T-25_data_train.npy.npz
Read file: S70e-12_H60_T-26_data_train.npy.npz
Read file: S70e-12_H70_T-24_data_train.npy.npz
Read file: S70e-12_H70_T-25_data_train.npy.npz
Read file: S70e-12_H70_T-26_data_train.npy.npz
Done reading all data
-----------------------------------
Done shuffling all data
Split train and test sets at a ratio of 0.8
Known data size: train(4, 256, 256, 1958)
                 test(4, 256, 256, 490)
Prediction data size: train(4, 256, 256, 1958)
                      test(4, 256, 256, 490)
-----------------------------------
-----------------------------------
┌─────────────────┬───────┬─────────┐
│           Phase │ Epoch │    Loss │
├─────────────────┼───────┼─────────┤
│ TrainingPhase() │   1.0 │ 0.05092 │
└─────────────────┴───────┴─────────┘
┌───────────────────┬───────┬───────┐
│             Phase │ Epoch │  Loss │
├───────────────────┼───────┼───────┤
│ ValidationPhase() │   1.0 │ 0.072 │
└───────────────────┴───────┴───────┘
┌─────────────────┬───────┬─────────┐
│           Phase │ Epoch │    Loss │
├─────────────────┼───────┼─────────┤
│ TrainingPhase() │   2.0 │ 0.02954 │
└─────────────────┴───────┴─────────┘
┌───────────────────┬───────┬─────────┐
│             Phase │ Epoch │    Loss │
├───────────────────┼───────┼─────────┤
│ ValidationPhase() │   2.0 │ 0.04746 │
└───────────────────┴───────┴─────────┘
┌─────────────────┬───────┬─────────┐
│           Phase │ Epoch │    Loss │
├─────────────────┼───────┼─────────┤
│ TrainingPhase() │   3.0 │ 0.02262 │
└─────────────────┴───────┴─────────┘
┌───────────────────┬───────┬─────────┐
│             Phase │ Epoch │    Loss │
├───────────────────┼───────┼─────────┤
│ ValidationPhase() │   3.0 │ 0.01241 │
└───────────────────┴───────┴─────────┘
┌─────────────────┬───────┬─────────┐
│           Phase │ Epoch │    Loss │
├─────────────────┼───────┼─────────┤
│ TrainingPhase() │   4.0 │ 0.02185 │
└─────────────────┴───────┴─────────┘
┌───────────────────┬───────┬─────────┐
│             Phase │ Epoch │    Loss │
├───────────────────┼───────┼─────────┤
│ ValidationPhase() │   4.0 │ 0.02116 │
└───────────────────┴───────┴─────────┘
┌─────────────────┬───────┬─────────┐
│           Phase │ Epoch │    Loss │
├─────────────────┼───────┼─────────┤
│ TrainingPhase() │   5.0 │ 0.01936 │
└─────────────────┴───────┴─────────┘
┌───────────────────┬───────┬─────────┐
│             Phase │ Epoch │    Loss │
├───────────────────┼───────┼─────────┤
│ ValidationPhase() │   5.0 │ 0.02277 │
└───────────────────┴───────┴─────────┘
┌─────────────────┬───────┬────────┐
│           Phase │ Epoch │   Loss │
├─────────────────┼───────┼────────┤
│ TrainingPhase() │   6.0 │ 0.0184 │
└─────────────────┴───────┴────────┘
┌───────────────────┬───────┬─────────┐
│             Phase │ Epoch │    Loss │
├───────────────────┼───────┼─────────┤
│ ValidationPhase() │   6.0 │ 0.01131 │
└───────────────────┴───────┴─────────┘
┌─────────────────┬───────┬─────────┐
│           Phase │ Epoch │    Loss │
├─────────────────┼───────┼─────────┤
│ TrainingPhase() │   7.0 │ 0.01964 │
└─────────────────┴───────┴─────────┘
┌───────────────────┬───────┬─────────┐
│             Phase │ Epoch │    Loss │
├───────────────────┼───────┼─────────┤
│ ValidationPhase() │   7.0 │ 0.01697 │
└───────────────────┴───────┴─────────┘
┌─────────────────┬───────┬─────────┐
│           Phase │ Epoch │    Loss │
├─────────────────┼───────┼─────────┤
│ TrainingPhase() │   8.0 │ 0.01882 │
└─────────────────┴───────┴─────────┘
┌───────────────────┬───────┬─────────┐
│             Phase │ Epoch │    Loss │
├───────────────────┼───────┼─────────┤
│ ValidationPhase() │   8.0 │ 0.01578 │
└───────────────────┴───────┴─────────┘
┌─────────────────┬───────┬─────────┐
│           Phase │ Epoch │    Loss │
├─────────────────┼───────┼─────────┤
│ TrainingPhase() │   9.0 │ 0.01669 │
└─────────────────┴───────┴─────────┘
┌───────────────────┬───────┬─────────┐
│             Phase │ Epoch │    Loss │
├───────────────────┼───────┼─────────┤
│ ValidationPhase() │   9.0 │ 0.02106 │
└───────────────────┴───────┴─────────┘
┌─────────────────┬───────┬─────────┐
│           Phase │ Epoch │    Loss │
├─────────────────┼───────┼─────────┤
│ TrainingPhase() │  10.0 │ 0.01681 │
└─────────────────┴───────┴─────────┘
┌───────────────────┬───────┬─────────┐
│             Phase │ Epoch │    Loss │
├───────────────────┼───────┼─────────┤
│ ValidationPhase() │  10.0 │ 0.00934 │
└───────────────────┴───────┴─────────┘
┌─────────────────┬───────┬─────────┐
│           Phase │ Epoch │    Loss │
├─────────────────┼───────┼─────────┤
│ TrainingPhase() │  11.0 │ 0.01589 │
└─────────────────┴───────┴─────────┘
┌───────────────────┬───────┬─────────┐
│             Phase │ Epoch │    Loss │
├───────────────────┼───────┼─────────┤
│ ValidationPhase() │  11.0 │ 0.00497 │
└───────────────────┴───────┴─────────┘
┌─────────────────┬───────┬─────────┐
│           Phase │ Epoch │    Loss │
├─────────────────┼───────┼─────────┤
│ TrainingPhase() │  12.0 │ 0.01621 │
└─────────────────┴───────┴─────────┘
┌───────────────────┬───────┬─────────┐
│             Phase │ Epoch │    Loss │
├───────────────────┼───────┼─────────┤
│ ValidationPhase() │  12.0 │ 0.01599 │
└───────────────────┴───────┴─────────┘
┌─────────────────┬───────┬────────┐
│           Phase │ Epoch │   Loss │
├─────────────────┼───────┼────────┤
│ TrainingPhase() │  13.0 │ 0.0153 │
└─────────────────┴───────┴────────┘
┌───────────────────┬───────┬─────────┐
│             Phase │ Epoch │    Loss │
├───────────────────┼───────┼─────────┤
│ ValidationPhase() │  13.0 │ 0.01447 │
└───────────────────┴───────┴─────────┘
┌─────────────────┬───────┬─────────┐
│           Phase │ Epoch │    Loss │
├─────────────────┼───────┼─────────┤
│ TrainingPhase() │  14.0 │ 0.01488 │
└─────────────────┴───────┴─────────┘
┌───────────────────┬───────┬─────────┐
│             Phase │ Epoch │    Loss │
├───────────────────┼───────┼─────────┤
│ ValidationPhase() │  14.0 │ 0.00322 │
└───────────────────┴───────┴─────────┘
┌─────────────────┬───────┬─────────┐
│           Phase │ Epoch │    Loss │
├─────────────────┼───────┼─────────┤
│ TrainingPhase() │  15.0 │ 0.01299 │
└─────────────────┴───────┴─────────┘
┌───────────────────┬───────┬─────────┐
│             Phase │ Epoch │    Loss │
├───────────────────┼───────┼─────────┤
│ ValidationPhase() │  15.0 │ 0.01759 │
└───────────────────┴───────┴─────────┘
┌─────────────────┬───────┬─────────┐
│           Phase │ Epoch │    Loss │
├─────────────────┼───────┼─────────┤
│ TrainingPhase() │  16.0 │ 0.01628 │
└─────────────────┴───────┴─────────┘
┌───────────────────┬───────┬─────────┐
│             Phase │ Epoch │    Loss │
├───────────────────┼───────┼─────────┤
│ ValidationPhase() │  16.0 │ 0.02197 │
└───────────────────┴───────┴─────────┘
┌─────────────────┬───────┬─────────┐
│           Phase │ Epoch │    Loss │
├─────────────────┼───────┼─────────┤
│ TrainingPhase() │  17.0 │ 0.01364 │
└─────────────────┴───────┴─────────┘
┌───────────────────┬───────┬─────────┐
│             Phase │ Epoch │    Loss │
├───────────────────┼───────┼─────────┤
│ ValidationPhase() │  17.0 │ 0.01335 │
└───────────────────┴───────┴─────────┘
┌─────────────────┬───────┬─────────┐
│           Phase │ Epoch │    Loss │
├─────────────────┼───────┼─────────┤
│ TrainingPhase() │  18.0 │ 0.01333 │
└─────────────────┴───────┴─────────┘
┌───────────────────┬───────┬─────────┐
│             Phase │ Epoch │    Loss │
├───────────────────┼───────┼─────────┤
│ ValidationPhase() │  18.0 │ 0.01416 │
└───────────────────┴───────┴─────────┘
┌─────────────────┬───────┬─────────┐
│           Phase │ Epoch │    Loss │
├─────────────────┼───────┼─────────┤
│ TrainingPhase() │  19.0 │ 0.01268 │
└─────────────────┴───────┴─────────┘
┌───────────────────┬───────┬─────────┐
│             Phase │ Epoch │    Loss │
├───────────────────┼───────┼─────────┤
│ ValidationPhase() │  19.0 │ 0.01475 │
└───────────────────┴───────┴─────────┘
┌─────────────────┬───────┬─────────┐
│           Phase │ Epoch │    Loss │
├─────────────────┼───────┼─────────┤
│ TrainingPhase() │  20.0 │ 0.01298 │
└─────────────────┴───────┴─────────┘
┌───────────────────┬───────┬─────────┐
│             Phase │ Epoch │    Loss │
├───────────────────┼───────┼─────────┤
│ ValidationPhase() │  20.0 │ 0.01401 │
└───────────────────┴───────┴─────────┘
Finished modeling
model: NeuralOperators.FourierNeuralOperator{Dense{typeof(identity), Matrix{Float32}, Vector{Float32}}, Chain{Tuple{NeuralOperators.OperatorKernel{Dense{typeof(identity), Matrix{Float32}, Vector{Float32}}, NeuralOperators.OperatorConv{false, Array{ComplexF32, 3}, Int64, NeuralOperators.FourierTransform{2, Int64}}, typeof(gelu)}, NeuralOperators.OperatorKernel{Dense{typeof(identity), Matrix{Float32}, Vector{Float32}}, NeuralOperators.OperatorConv{false, Array{ComplexF32, 3}, Int64, NeuralOperators.FourierTransform{2, Int64}}, typeof(gelu)}, NeuralOperators.OperatorKernel{Dense{typeof(identity), Matrix{Float32}, Vector{Float32}}, NeuralOperators.OperatorConv{false, Array{ComplexF32, 3}, Int64, NeuralOperators.FourierTransform{2, Int64}}, typeof(gelu)}, NeuralOperators.OperatorKernel{Dense{typeof(identity), Matrix{Float32}, Vector{Float32}}, NeuralOperators.OperatorConv{false, Array{ComplexF32, 3}, Int64, NeuralOperators.FourierTransform{2, Int64}}, typeof(identity)}}}, Chain{Tuple{Dense{typeof(gelu), Matrix{Float32}, Vector{Float32}}, Dense{typeof(identity), Matrix{Float32}, Vector{Float32}}}}}(Dense(4 => 64), Chain(OperatorKernel(64 => 64, (12, 12), FourierTransform, σ=gelu, permuted=false), OperatorKernel(64 => 64, (12, 12), FourierTransform, σ=gelu, permuted=false), OperatorKernel(64 => 64, (12, 12), FourierTransform, σ=gelu, permuted=false), OperatorKernel(64 => 64, (12, 12), FourierTransform, σ=identity, permuted=false)), Chain(Dense(64 => 128, gelu), Dense(128 => 4)))
Model saved to: /home/groups/jsuckale/liuwj/elle/dl_model/ElleFNO/examples/../model/fno_model_gpu_Nx256.bson
